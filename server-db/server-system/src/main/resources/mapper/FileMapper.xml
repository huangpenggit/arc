<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- Mybatis mapper for file  Auto generated by fms-mybatis-generator -->
<mapper namespace="com.arc.server.system.mapper.FileMapper">
    <resultMap id="file" type="com.arc.model.domain.common.SystemFile">
        <id property="id" column="file_id" javaType="long" jdbcType="BIGINT"/>
        <result property="url" column="file_url" javaType="string" jdbcType="VARCHAR"/>
        <result property="path" column="file_path" javaType="string" jdbcType="VARCHAR"/>
        <result property="name" column="file_name" javaType="string" jdbcType="VARCHAR"/>
        <result property="suffix" column="file_suffix" javaType="string" jdbcType="VARCHAR"/>
        <result property="createDate" column="file_create_date" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="updateDate" column="file_update_date" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
    </resultMap>

    <sql id="fileColumnsSQL">
        file_.id AS file_id,
        file_.url AS file_url,
        file_.path AS file_path,
        file_.`name` AS file_name,
        file_.suffix AS file_suffix,
        file_.create_date AS file_create_date,
        file_.update_date AS file_update_date
    </sql>


    <select id="get" parameterType="long" resultMap="file">
        SELECT
        <include refid="fileColumnsSQL"/>
        FROM file file_
        WHERE file_.id = #{id,jdbcType=BIGINT}
    </select>

    <delete id="delete" parameterType="long">
        DELETE FROM file     WHERE id = #{id,jdbcType=BIGINT}
    </delete>

    <!--获取全部的数据-->
    <select id="list" resultMap="file">
        SELECT
        <include refid="fileColumnsSQL"/>
        FROM file file_
    </select>

    <select id="getLatest" parameterType="string" resultMap="file">
        SELECT
        <include refid="fileColumnsSQL"/>
        FROM file file_
        ORDER BY file_.update_date DESC
        LIMIT 0,1
    </select>

    <select id="getByFilename" parameterType="string" resultMap="file">
        SELECT
        <include refid="fileColumnsSQL"/>
        FROM file file_
        WHERE file_.`name` = #{name,jdbcType=VARCHAR}
    </select>

    <select id="getByFilePath" parameterType="string" resultMap="file">
        SELECT
        <include refid="fileColumnsSQL"/>
        FROM file file_
        WHERE file_.path = #{filePath,jdbcType=VARCHAR}
    </select>

    <select id="getByUrl" parameterType="string" resultMap="file">
        SELECT
        <include refid="fileColumnsSQL"/>
        FROM file file_
        WHERE file_.url = #{url,jdbcType=VARCHAR}
    </select>

    <insert id="save" parameterType="com.arc.model.domain.common.SystemFile" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO file (
        url,
        path,
        `name`,
        suffix,
        create_date,
        update_date
        )
        VALUES (
        #{url,jdbcType=VARCHAR},
        #{path,jdbcType=VARCHAR},
        #{name,jdbcType=VARCHAR},
        #{suffix,jdbcType=VARCHAR},
        now(),
        now()
        )
    </insert>

    <update id="update" parameterType="com.arc.model.domain.common.SystemFile">
        UPDATE file
        <set>
            <if test="url != null and url != ''">url = #{url,jdbcType=VARCHAR},</if>
            <if test="path != null and path != ''">path = #{path,jdbcType=VARCHAR},</if>
            <if test="name != null and name != ''">`name` = #{name,jdbcType=VARCHAR},</if>
            <if test="suffix != null and suffix != ''">suffix = #{suffix,jdbcType=VARCHAR},</if>
            <if test="createDate != null">create_date = #{createDate,jdbcType=TIMESTAMP},</if>
            <if test="updateDate != null">update_date = #{updateDate,jdbcType=TIMESTAMP},</if>
        </set>
        WHERE id = #{id,jdbcType=BIGINT}
    </update>

</mapper>
